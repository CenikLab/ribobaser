% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/select_genes.R
\name{select_genes}
\alias{select_genes}
\title{Select subset of genes for downstream processing}
\usage{
select_genes(RIBO, RNA, dummy = TRUE, cpm = 1, fraction = 0.8)
}
\arguments{
\item{RIBO}{numeric matrix or data.frame with genes in rows and samples in columns}

\item{RNA}{numeric matrix or data.frame with genes in rows and samples in columns}

\item{dummy}{logical. If TRUE add a row that contains the column sums of removed genes}

\item{cpm}{numeric CPM threshold. Default 1}

\item{fraction}{numeric between 0,1. A gene is kept only if at least this fraction
of the combined columns has CPM >= \code{cpm}. Default 0.8}
}
\value{
list with elements:
\itemize{
\item ribo: filtered RIBO matrix (genes by samples, with optional dummy row)
\item rna:  filtered RNA matrix (genes by samples, with optional dummy row)
\item kept_genes: character vector of kept gene ids
\item removed_genes: character vector of removed gene ids
}
}
\description{
Assumptions
\enumerate{
\item Inputs are genes by samples
\item Both RNA and Ribo are calculated for same set of samples
}
}
\details{
Existing features
a) If \code{dummy = TRUE} the counts of removed genes are summed into a new row
b) CPM is computed column-wise in each matrix and evaluated over the combined columns

Optional features to Implement later
a) Support only ribo or RNA
b) Support removing genes without polyA genes
}
\examples{
set.seed(3)
G <- 100; S <- 8
RIBO <- matrix(rpois(G*S, 20), nrow = G,
               dimnames = list(paste0("g",1:G), paste0("s",1:S)))
RNA  <- matrix(rpois(G*S, 25), nrow = G,
               dimnames = list(paste0("g",1:G), paste0("s",1:S)))
# make some low CPM genes
RIBO[1:5,] <- 0
RNA [1:5,] <- 0
sel <- select_genes(RIBO, RNA, cpm = 1, fraction = 0.8, dummy = TRUE)
dim(sel$ribo); dim(sel$rna)
}
