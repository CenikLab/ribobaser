% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/select_samples.R
\name{select_samples}
\alias{select_samples}
\title{Select subset of samples for downstream processing}
\usage{
select_samples(
  RIBO,
  RNA,
  high_dummy_percentage = 0,
  min_r2 = 0,
  min_periodicity = 0
)
}
\arguments{
\item{RIBO}{numeric matrix or data.frame with genes in rows and samples in columns}

\item{RNA}{numeric matrix or data.frame with genes in rows and samples in columns}

\item{high_dummy_percentage}{numeric between 0 and 1. Remove samples where \code{DUMMY_REMOVED}
exceeds this fraction of the remaining counts in RIBO or RNA. Set to 0 to keep all samples.}

\item{min_r2}{numeric between 0 and 1 specifying the minimum coefficient of determination
(R-squared) required between CLR-normalised RIBO and RNA counts within each sample. Samples
with \code{R_squared < min_r2} are removed. Set to 0 to skip this filter.}

\item{min_periodicity}{numeric between 0 and 1 specifying the minimum periodicity score
required for a sample based on \verb{Ribobase_QC_non_dedup_data$\\}Periodicity score\``. Set to 0
to keep all samples regardless of periodicity.}
}
\value{
list with elements:
\itemize{
\item ribo: filtered RIBO matrix (genes by samples)
\item rna:  filtered RNA matrix (genes by samples)
}
}
\description{
Assumptions
\enumerate{
\item Inputs are genes by samples
\item Both RNA and Ribo are calculated for same set of samples
\item The data represents read counts and is not cpm/clr normalized.
}
}
\details{
Existing features
a) Support removing samples where dummy genes is a large proportion of the remaining
b) Support removing samples with poor correspondence between RNA and Ribo
this is currently done after adding one count to all values to avoid zeros
then each is clr normalized and r2 from lm(RIBO~RNA) is used for selecting samples to remove

Optional features to Implement later
a) Support only ribo or RNA
}
\examples{
set.seed(3)
# two genes plus the dummy row, three samples
RIBO <- matrix(
  c(100, 120, 80,    # g1
    150, 130, 90,    # g2
     10, 200,  5),   # DUMMY_REMOVED
  nrow = 3, byrow = TRUE,
  dimnames = list(c("g1","g2","DUMMY_REMOVED"), paste0("s", 1:3))
)
RNA <- matrix(
  c(200, 210, 190,   # g1
    300, 290, 280,   # g2
     15, 250,  8),   # DUMMY_REMOVED
  nrow = 3, byrow = TRUE,
  dimnames = list(c("g1","g2","DUMMY_REMOVED"), paste0("s", 1:3))
)

# Remove samples where DUMMY_REMOVED > 40 percent of remaining counts in either modality
res <- select_samples(RIBO, RNA, high_dummy_percentage = 0.4)
colnames(res$ribo)  # samples kept

}
