% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TE.R
\name{te}
\alias{te}
\title{Translation efficiency via compositional regression or CLR difference}
\usage{
te(
  RIBO,
  RNA,
  method = c("regression", "logratio"),
  parallel = FALSE,
  n_cores = max(1L, parallel::detectCores() - 1L)
)
}
\arguments{
\item{RIBO}{numeric matrix or data.frame with samples in rows and genes in columns}

\item{RNA}{numeric matrix or data.frame with samples in rows and genes in columns}

\item{method}{character string selecting the TE estimator. \code{'regression'}
runs the compositional regression workflow, \code{'logratio'} returns
\code{clr(RIBO) - clr(RNA)}.}

\item{parallel}{logical run with foreach dopar (only used for
\code{method = "regression"}).}

\item{n_cores}{integer cores for parallel (only used for
\code{method = "regression"}).}
}
\value{
numeric matrix genes by samples
}
\description{
Compute TE from paired ribosome profiling and
RNA-seq counts under compositional data analysis principles.
}
\details{
This function supports two  approaches controlled by \code{method}:
\itemize{
\item \code{'regression'} (default) reproduces the Liu et al 2025 workflow
that converts CLR values to ILR coordinates and
regresses ILR(RIBO) on ILR(RNA) per sample, mapping residuals back to CLR space.
\item \code{'logratio'} computes the simpler CLR difference \code{clr(RIBO) - clr(RNA)}
}

Assumptions
\enumerate{
\item Inputs are samples by genes.
\item Zeros were handled before calling this function.
\item No internal scaling or centering is performed.
}

Things to Check
\enumerate{
\item Consider switching out propr call with the simple function. Make sure the equivalence/zero handling
}
}
\examples{
RIBO <- matrix(c(5, 7, 9,
                 6, 8, 10),
               nrow = 2,
               byrow = TRUE,
               dimnames = list(paste0("g", 1:2), paste0("s", 1:3)))
RNA <- matrix(c(4, 6, 8,
                5, 7, 9),
              nrow = 2,
              byrow = TRUE,
              dimnames = list(paste0("g", 1:2), paste0("s", 1:3)))
te(RIBO, RNA, method = "logratio")


}
